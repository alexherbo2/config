source "%val{runtime}/rc/core/c-family.kak"
source "%val{runtime}/rc/core/comment.kak"
source "%val{runtime}/rc/core/diff.kak"
source "%val{runtime}/rc/core/doc.kak"
source "%val{runtime}/rc/core/formatter.kak"
source "%val{runtime}/rc/core/grep.kak"
source "%val{runtime}/rc/core/kakrc.kak"
source "%val{runtime}/rc/core/makefile.kak"
source "%val{runtime}/rc/core/make.kak"
source "%val{runtime}/rc/core/man.kak"
source "%val{runtime}/rc/core/python.kak"
source "%val{runtime}/rc/core/sh.kak"

source "%val{runtime}/rc/base/ctags.kak"
source "%val{runtime}/rc/base/etc.kak"
source "%val{runtime}/rc/base/file.kak"
source "%val{runtime}/rc/base/git.kak"
source "%val{runtime}/rc/base/go.kak"
source "%val{runtime}/rc/base/javascript.kak"
source "%val{runtime}/rc/base/json.kak"
source "%val{runtime}/rc/base/lint.kak"
source "%val{runtime}/rc/base/lua.kak"
source "%val{runtime}/rc/base/markdown.kak"
source "%val{runtime}/rc/base/rust.kak"
source "%val{runtime}/rc/base/x11.kak"

source "%val{runtime}/rc/extra/autorestore.kak"
source "%val{runtime}/rc/extra/clang.kak"
source "%val{runtime}/rc/extra/git-tools.kak"
source "%val{runtime}/rc/extra/x11-repl.kak"

source "%val{config}/buffers-info.kak"
source "%val{config}/expand.kak"
source "%val{config}/filetree.kak"
source "%val{config}/find.kak"
source "%val{config}/friendly-session-names.kak"
source "%val{config}/gdb-helper.kak"
source "%val{config}/gdb.kak"
source "%val{config}/multiples.kak"
source "%val{config}/phantom-selection.kak"
source "%val{config}/single-process-pipe.kak"
source "%val{config}/sudo-write.kak"
source "%val{config}/surround.kak"
source "%val{config}/vertical-selection.kak"

set-option global tabstop 4
set-option global indentwidth 4
set-option global BOM none
set-option global eolformat lf

set-option global gdb_breakpoint_active_symbol "x"
set-option global gdb_breakpoint_inactive_symbol "o"
set-option global gdb_location_symbol "->"

set-option global autoinfo command|onkey

set-option global ui_options ncurses_assistant=none

set-option global scrolloff 2,5

set-option global makecmd 'make --jobs=8'
set-option global grepcmd 'ag --filename --column --ignore tags'
set-option global termcmd 'termite -e'

set-option global modelinefmt '%val{bufname} %val{cursor_line}:%val{cursor_char_column} {{context_info}} {{mode_info}} {red,default}%opt{gdb_indicator}%opt{gdb_autojump_indicator}{default,default}- %val{client}@[%val{session}]'

# stop c and d from yanking
map global normal d \"_d
map global normal c \"_c

map global goto p "<esc>:find<ret>"
map global goto d "<esc>:ctags-search<ret>"

# tab/backtab to cycle through completions
hook global InsertCompletionShow .* %{
    map window insert <backtab> <c-p>
    map window insert <tab> <c-n>
}
hook global InsertCompletionHide .* %{
    unmap window insert <tab> <c-n>
    unmap window insert <backtab> <c-p>
}

# use w to select current word
map global normal w <a-i>w
map global normal W <a-i>W
map global normal <a-w> ""
map global normal <a-W> ""

set-face SecondaryCursor black,rgb:babaa3
set-face Whitespace rgb:363636,default
set-face LineNumbersWrapped rgb:606060,default+i

add-highlighter global number_lines -hlcursor -separator ' '
add-highlighter global show_matching
add-highlighter global dynregex '%reg{/}' 0:default,+u
add-highlighter global show_whitespaces
add-highlighter global wrap -word

define-command reload-all -docstring "Reload all open buffers" %{
    eval -buffer * edit!
}

define-command kakrc -docstring "Open kakrc" %{
    edit ~/.config/kak/kakrc
}

define-command trim-whitespaces -docstring "Remove trailing whitespace from every line" %{
   try %{
        exec -draft '%s\h+$<ret>d'
        echo -markup "{Information}trimmed"
    } catch %{
        echo -markup "{Information}nothing to trim"
    }
}

define-command ide %{
    rename-client main
    new rename-client tools
    set global toolsclient tools
    set global jumpclient main
}

map -docstring "surround" global user s :surround<ret>
map -docstring "surround (repeat)" global user S :surround-repeat<ret>
map -docstring "expand" global user e :expand<ret>
map -docstring "expand (repeat)" global user E :expand-repeat<ret>
map -docstring "select down" global user v :select-down<ret>
map -docstring "select up" global user <a-v> :select-up<ret>
map -docstring "select vertically" global user V :select-vertically<ret>
map -docstring "phantom next" global user f :phantom-sel-iterate-next<ret>
map -docstring "phantom prev" global user <a-f> :phantom-sel-iterate-prev<ret>
map -docstring "phantom clear" global user F ":phantom-sel-select-all; phantom-sel-clear<ret>"
map -docstring "unselect whitespace" global user w '"_1s\s*(.*[^\s])\s*<ret>'
map -docstring "trim whitespaces" global user W :trim-whitespaces<ret>
map -docstring "clip-paste after" global user p '<a-!>xsel --output --clipboard<ret>'
map -docstring "clip-paste before" global user P '!xsel --output --clipboard<ret>'
map -docstring "clip-paste replace" global user R '|xsel --output --clipboard<ret>'
map -docstring "clip-yank" global user y '<a-|>xsel --input --clipboard<ret>'

map global normal <a-,> :bp<ret>
map global normal <a-.> :bn<ret>
map global normal <a-w> :w<ret>
map global normal <a-r> :e!<ret>
map global normal <a-d> :db<ret>
map global normal <a-q> :db!<ret>

try %{ source "%val{config}/dayjob.kak" }
